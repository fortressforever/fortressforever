<?/*	app_sql.php		this file provides functions for sql abstraction.	Created by: Kevin Hjelden	Last Update: 4/28/01*/require_once "app_debug.php";/* make the sql database available to the page */function sql_start() {	global $sql;	$sql = mysql_connect("localhost", "root", "");	if (!$sql) die("could not open database");	$ret = mysql_select_db("ff", $sql);	if (!$ret) die("could not select database");	}/* Query the database. This function returns data in an array format. To use the	contents of the return values from this function, you must use array functions	instead of mysql functions to provide more ease when moving to a different	database server. Also by abstracting this, you can easily add debuging of the	sql queries thoughout all of the pages by putting the debug stuff in here */function sql_query($query) {	global $sql;$start=microtime();	if (!$sql)		sql_start();	//$query = str_replace('\\"', '"', $query);	//$query = str_replace('\\\'', "''", $query);	$sql_results = mysql_query($query, $sql);		if (!$sql_results) {		$q_error = mysql_error($sql);//		log_write("MYSQL ERROR [$query] : $q_error");		die ("query failed [$query] ($q_error)");	}		$num_rows = @mysql_num_rows($sql_results);	$affected_rows = 0;	// put the sql results into an array	$i=0;	$results=array();	if ($num_rows) {		while ($row=mysql_fetch_array($sql_results)) {			$results[$i++]=$row;		}	}	//$results = mysql_fetch_all($sql_results);$stop=microtime();	$tmp1=split(" ",$start); 	$tmp2=split(" ",$stop); 	$time=ceil((($tmp2[1]-$tmp1[1])+$tmp2[0]-$tmp1[0])*1000);	if (function_exists("debug_add"))		//debug_add("\n<b>Query</b>: ($num_rows rows; $time ms):\n$query\n\n");		debug_add("\n<b>Query</b>: ($num_rows rows; $time ms):\n$query\n\n");	//@mysql_free_result($sql_results);	return $results;}function sql_exec($query) {	global $sql;$start=microtime();	if (!$sql)		sql_start();	//$query = str_replace('\\"', '"', $query);	//$query = str_replace('\\\'', "''", $query);	$sql_results = mysql_exec($sql, $query);		if (!$sql_results) {		$q_error = mysql_error_string(mysql_last_error($sql));//		log_write("MYSQL ERROR [$query] : $q_error");		die ("query failed [$query] ($q_error)");	}$stop=microtime();	$tmp1=split(" ",$start); 	$tmp2=split(" ",$stop); 	$time=ceil((($tmp2[1]-$tmp1[1])+$tmp2[0]-$tmp1[0])*1000);	if (function_exists("debug_add"))		//debug_add("\n<b>Query</b>: ($num_rows rows; $time ms):\n$query\n\n");		debug_add("\n<b>Exec</b>: ($time ms):\n$query\n\n");	//@mysql_free_result($sql_results);	return true;}?>